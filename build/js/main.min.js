"use strict";var app=angular.module("hairvenApp",["ngFileUpload","ui.router","ngStorage","satellizer","ngToast"]);app.config(["$stateProvider","$urlRouterProvider","$locationProvider","$authProvider","ngToastProvider",function(e,t,s,a,n){e.state("home",{url:"/",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@home":{templateUrl:"app/partials/home.view.html",controller:"HomeCtrl"}}}).state("hair",{url:"/hair",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@hair":{templateUrl:"app/partials/hair.view.html",controller:"HairCtrl"}}}).state("dashboard",{url:"/dashboard",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@dashboard":{templateUrl:"app/partials/dashboard.view.html"}}}).state("contact",{url:"/contact",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@contact":{templateUrl:"app/partials/contact.view.html"}}}).state("Userdashboard",{url:"/userdashboard",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@Userdashboard":{templateUrl:"app/partials/Userdashboard.view.html"}}}).state("gallery",{url:"/gallery",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@gallery":{templateUrl:"app/partials/userGallery.view.html",controller:"HairCtrl"}}}).state("booking",{url:"/booking",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@booking":{templateUrl:"app/partials/booking.view.html"}}}).state("salongallery",{url:"/salongallery",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@salongallery":{templateUrl:"app/partials/shopOwnerGallery.view.html",controller:"HairCtrl"},"sideNav@salongallery":{templateUrl:"app/partials/salonSidenav.view.html",controller:"SalonCtrl"}}}).state("salon",{url:"/salon",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@salon":{templateUrl:"app/partials/salonPage.view.html"}}}).state("login",{url:"/login",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@login":{templateUrl:"app/partials/login.view.html",controller:"UserCtrl"}}}).state("registersalon",{url:"/registersalon",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@registersalon":{templateUrl:"app/partials/salonSignup.view.html",controller:"UserCtrl"}}}),a.authHeader="x-access-token",n.configure({animation:"slide"}),t.otherwise("/"),s.html5Mode(!0),a.facebook({clientId:"1863446777214443"}),a.twitter({url:"/api/auth/twitter"})}]),angular.module("hairvenApp").controller("HairCtrl",["$scope","HairstyleService","$state","$rootScope","ngToast","Upload","baseUrl",function(e,t,s,a,n,r,i){e.addHairstyle=function(){var r=e.imageFile,i={name:e.name,description:e.description,salon:a.$storage.activeSalons[0]};t.addHairstyle(r,i).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),s.reload()}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getAllHairstyles=function(){t.getAllHairstyles().success(function(t){e.hairstyles=t}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getSalonHairstyles=function(s){var r=s||a.$storage.activeSalons[0];t.getSalonHairstyles(r).success(function(t){e.hairstyles=t.message||t}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getOneHairstyle=function(e){t.getOneHairstyle(e).success(function(e){a.$storage.currentHairstyle=e.body}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.updateHairstyle=function(a){var r={name:e.name,description:e.description,salon:salonId};t.updateHairstyle(r).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),s.go("salongallery")}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.deleteHairstyle=function(e){t.deleteHairstyle(e).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}}]),angular.module("hairvenApp").controller("HomeCtrl",["$scope","$state",function(e,t){$(function(){$(".roll").css("opacity","0"),$(".roll").hover(function(){$(this).stop().animate({opacity:.7},"slow")},function(){$(this).stop().animate({opacity:0},"slow")})}),e.redirect=function(e){t.go(e)}}]),angular.module("hairvenApp").controller("SalonCtrl",["SalonService","$scope","$state","$rootScope","ngToast",function(e,t,s,a,n){t.addSalon=function(){var t={name:scope.salonName,address:scope.salonAddress};e.addSalon(t).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},t.getSalon=function(s){var r=s||a.$storage.activeSalons[0];e.getSalon(r).success(function(e){t.salonName=e.name,t.salonAddress=e.address}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},t.updateSalon=function(t){var s={name:scope.salonName,address:scope.salonAddress};e.updateSalon(t,s).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},t.deleteSalon=function(t){e.deleteSalon(t).success(function(e){n.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){n.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}}]),angular.module("hairvenApp").controller("UserCtrl",["UserService","SalonService","$rootScope","$window","$scope","$state","$localStorage","$auth","ngToast",function(e,t,s,a,n,r,i,o,l){s.$storage=i,n.loggedIn=i.loggedIn,n.signin=function(){var t={username:n.username,password:n.password};e.login(t).success(function(e){"user"===e.user.role?(o.setToken(e.token),s.$storage.activeUser=e.user.username,s.$storage.userId=e.user._id,r.go("home")):(o.setToken(e.token),s.$storage.activeStylist=e.user.username,s.$storage.stylistId=e.user._id,s.$storage.activeSalons=e.user.salons,r.go("salongallery")),s.$storage.loggedIn=!0,l.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},n.signup=function(){var s={name:n.salonName,address:n.salonAddress},a={name:{first:n.first,last:n.last},username:n.username,email:n.email,password:n.password,role:"user"};s.name&&s.address?t.addSalon(s).success(function(t){a.salons=t.salon._id,a.role="stylist",e.register(a).success(function(e){l.create({className:"success",content:e.message+" click on login to continue",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}):e.register(a).success(function(e){r.go("login"),l.create({className:"success",content:e.message+" login to continue",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},n.logout=function(){o.removeToken(),s.$storage.$reset(),e.logout(function(){"home"===r.$current.name?r.reload():r.go("home"),l.create({className:"success",content:"successfully logged out",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})},function(){l.create({className:"danger",content:"failed to logout!",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},n.authenticate=function(e){o.authenticate(e).then(function(e){o.setToken(e.data.token),s.$storage.activeUser=e.data.user.username,s.$storage.userId=e.data.user._id,r.go("home"),s.$storage.loggedIn=!0,l.create({className:"success",content:"You are signed in",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})["catch"](function(e){l.create({className:"danger",content:e.data.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},n.isAuthenticated=function(){o.isAuthenticated()}}]),angular.module("hairvenApp").value("baseUrl","http://localhost:3030");var app=angular.module("hairvenApp");app.factory("HairstyleService",["$http","baseUrl","$localStorage","Upload",function(e,t,s,a){var n={getAllHairstyles:function(){return e.get(t+"/api/hairstyles/")},getSalonHairstyles:function(s){return e.get(t+"/api/salons/"+s+"/hairstyles")},getOneHairstyle:function(s){return e.get(t+"/api/hairstyles/"+s)},addHairstyle:function(e,s){return a.upload({url:t+"/api/hairstyles",data:{hairPhoto:e,name:s.name,description:s.description,salon:s.salon},method:"POST"})},updateHairstyle:function(s,a){return e.put(t+"/api/hairstyles/"+s,a)},deleteHairstyle:function(s){return e["delete"](t+"/api/hairstyles/"+s)}};return n}]);var app=angular.module("hairvenApp");app.factory("SalonService",["$http","baseUrl","$localStorage",function(e,t,s){var a={getSalon:function(s){return e.get(t+"/api/salons/"+s)},addSalon:function(s){return e.post(t+"/api/salons/",s)},updateSalon:function(s,a){return e.put(t+"/api/salons/"+s,a)},deleteSalon:function(s){return e["delete"](t+"/api/salons/"+s)}};return a}]);var app=angular.module("hairvenApp");app.factory("UserService",["$http","baseUrl","$localStorage",function(e,t,s){function a(e){var t=e.replace("-","+").replace("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}return window.atob(t)}function n(){var e=s.token,t={};if("undefined"!=typeof e){var n=e.split(".")[1];t=JSON.parse(a(n))}return t}function r(e){angular.extend(i.currentUser,e)}var i=(n(),{register:function(s){return e.post(t+"/api/signup",s)},login:function(s){return e.post(t+"/api/login",s)},facebookLogin:function(){e.get(t+"/api/auth/facebook/")},twitterLogin:function(){e.get(t+"/api/auth/twitter/")},logout:function(e){r({}),e()},currentUser:function(){n()},updateUser:function(s,a,n){e.put(t+"/api/users/"+s).success(a).error(n)},deleteUser:function(s,a,n){e["delete"](t+"/api/users/"+s).success(a).error(n)}});return i}]);