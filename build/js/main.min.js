function authRoutes(e){e.route("/auth/facebook/").post(authCtrl.facebookSignin),e.route("/auth/twitter/").post(authCtrl.twitterSignin),e.route("/signup").post(authCtrl.signup),e.route("/login").post(authCtrl.login)}function hairstyleRoutes(e){e.route("/hairstyles").get(hairCtrl.getAllHairStyles).post(hairCtrl.createHairStyle),e.route("/salons/:id/hairstyles").get(hairCtrl.getSalonHairStyles),e.route("/hairstyles/:id").get(hairCtrl.getById).put(hairCtrl.updateHairStyle)["delete"](hairCtrl.removeHairStyle)}function routes(e){authRoutes(e),hairstyleRoutes(e),salonRoutes(e),userRoutes(e),searchRoutes(e)}function salonRoutes(e){e.route("/salons").post(salonCtrl.createSalon),e.route("/salons/:id").get(salonCtrl.getSalon).put(salonCtrl.updateSalon)["delete"](salonCtrl.deleteSalon)}function searchRoutes(e){e.route("/search").post(searchCtrl.search)}function userRoutes(e){e.route("/v1/users/:username").get(userCtrl.authMiddleware,userCtrl.getUser).put(userCtrl.authMiddleware,userCtrl.editProfile)["delete"](userCtrl.authMiddleware,userCtrl.deleteUser)}var jwt=require("jsonwebtoken"),User=require("../models/user.model"),config=require("../../config/config"),auth=require("../../config/auth"),request=require("request"),qs=require("qs"),validator=require("./validator"),generatePassword=function(){for(var e=8,s="0123456789abcdefghijklnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$^&%*()+=-[]{}|:<>?,.",t="",r=0;e>r;++r)t+=s.charAt(Math.floor(Math.random()*s.length));return t};exports.signup=function(e,s){var t=e.body,r=validator.validate(t);if(typeof r==typeof[]&&r.length>0){var a=r.join(", ");s.status(401).send({success:!1,message:a})}else{var o=new User(t);o.save(function(e){return e?(console.log(e),11e3===e.code?s.status(401).send({success:!1,message:"Username already exists!"}):s.status(401).send(e)):void s.send({success:!0,message:"Account created!"})})}},exports.login=function(e,s){User.findOne({username:e.body.username}).select("username password role salons").exec(function(t,r){if(t)throw t;if(!r)return s.status(401).send({success:!1,message:"Invalid Username or Password!"});var a=r.comparePassword(e.body.password);if(!a)return s.status(401).send({success:!1,message:"Invalid Username or Password!"});var o=jwt.sign(r,config.secret,{expiresInMinutes:1440});s.send({success:!0,message:"You are logged in",token:o,user:r})})},exports.twitterSignin=function(e,s){var t="https://api.twitter.com/oauth/request_token",r="https://api.twitter.com/oauth/access_token",a="https://api.twitter.com/1.1/users/show.json?screen_name=";if(e.body.oauth_token&&e.body.oauth_verifier){var o={consumer_key:auth.twitterAuth.consumerKey,consumer_secret:auth.twitterAuth.consumerSecret,token:e.body.oauth_token,verifier:e.body.oauth_verifier};request.post({url:r,oauth:o},function(t,r,o){o=qs.parse(o);var n={consumer_key:auth.twitterAuth.consumerKey,consumer_secret:auth.twitterAuth.consumerSecret,oauth_token:o.oauth_token};request.get({url:a+o.screen_name,oauth:n,json:!0},function(t,r,a){e.body.oauth_token?User.find({username:a.screen_name},function(e,t){if(!t.username){var r=a.name.split(" "),o=new User;o.username=a.screen_name,o.email=t.username+"unknown@unknown",o.name={first:r[0]||"none",last:r[1]||"none"},o.role="user",o.password=generatePassword(),o.save(function(e){return e?e:void 0})}s.status(200).send({success:!0,token:jwt.sign(t,config.secret,{expiresInMinutes:1440}),user:o})}):s.status(400).send({success:!1,message:"Hoops! Error, try again."})})})}else{var n={consumer_key:auth.twitterAuth.consumerKey,consumer_secret:auth.twitterAuth.consumerSecret,callback:e.body.redirectUri};request.post({url:t,oauth:n},function(e,t,r){var a=qs.parse(r);s.send(a)})}},exports.facebookSignin=function(e,s){var t="https://graph.facebook.com/v2.3/oauth/access_token",r="https://graph.facebook.com/v2.3/me",a={code:e.body.code,client_id:e.body.clientId,client_secret:auth.facebookAuth.clientSecret,redirect_uri:e.body.redirectUri};request.get({url:t,qs:a,json:!0},function(t,a,o){return 200!==a.statusCode?s.status(500).send({message:o.error.message}):void request.get({url:r,qs:o,json:!0},function(t,r,a){if(200!==r.statusCode)return s.status(500).send({message:a.error.message});if(console.log(e.body),e.body.code){var o=a.name.split(" ");User.find({username:o[0]},function(e,t){if(!t.username){var r=new User;r.username=o[0],r.email=t.username+"unknown@unknown",r.name={first:o[0],last:o[1]},r.role="user",r.password=generatePassword(),r.save(function(e){return e?e:void 0})}s.status(200).send({success:!0,token:jwt.sign(t,config.secret,{expiresInMinutes:1440}),user:r})})}else s.status(400).send({success:!1,message:"Hoops! Error, try again."})})})};var mongoose=require("mongoose"),cloudinary=require("cloudinary"),config=require("../../config/config"),Hair=require("../models/hairstyle.model"),Salon=require("../models/salon.model");cloudinary.config({cloud_name:config.cloudinary.cloud_name,api_key:config.cloudinary.api_key,api_secret:config.cloudinary.api_secret}),module.exports={createHairStyle:function(e,s){if(e.file){var t=e.body;if(t.name)if(t.description){var r=e.file.path;cloudinary.uploader.upload(r,function(e){var r=new Hair(t);r.image=e.secure_url,r.save(function(e){e?s.send(e):Salon.update({_id:t.salon},{$addToSet:{hairstyles:r}},function(e,t){return e?e:void s.send({success:!0,message:"Hairstyle Saved!"})})})},{use_filename:!0},{width:400,height:600,crop:"crop"})}else s.status(401).send({success:!1,message:"Please enter a description for the Hairstyle"});else s.status(401).send({success:!1,message:"Please enter Hairstyle name"})}else s.status(401).send({success:!1,message:"Please upload a photo of the Hairstyle"})},getAllHairStyles:function(e,s){Hair.find({}).populate("salon").exec(function(e,t){e?s.send(e):t?s.json(t):s.status(404).send({success:!1,message:"Hairstyles not found"})})},getSalonHairStyles:function(e,s){Hair.find({salon:e.params.id}).populate("salon").exec(function(e,t){e?s.send(e):t?s.json(t):s.status(404).send({success:!1,message:"You currently have no Hairstyles"})})},getById:function(e,s){Hair.findById(e.params.id).populate("salon").exec(function(e,t){e?s.send(e):t?s.json(t):s.status(404).send({success:!1,message:"Hairstyle not found"})})},updateHairStyle:function(e,s){Hair.update(e.params.id,e.body,function(e,t){e?s.send(e):s.send({success:!0,message:"Hairstyle Details Updated!"})})},removeHairStyle:function(e,s){Hair.findById(e.params.id).remove(function(e,t){e?(console.log(e),s.send({success:!1,message:"error deleting hairstyle"})):Salon.update({_id:t.salon},{$pull:{hairstyles:t._id}},function(e,t){e?console.log(e):s.send({success:!0,message:"Hairstyle Deleted Successfully!"})})})}};var mongoose=require("mongoose"),config=require("../../config/config"),Salon=require("../models/salon.model");module.exports={createSalon:function(e,s){if(e.body.name)if(e.body.address){var t=new Salon(e.body);t.save(function(e){e?s.send(e):s.send({success:!0,message:"your salon successfully added to list",salon:t})})}else s.status(401).send({success:!1,message:"Please enter the address of your salon"});else s.status(401).send({success:!1,message:"Please enter the name of your salon"})},getSalon:function(e,s){Salon.findById(e.params.id).populate("hairstyles").exec(function(e,t){e?s.send(e):t?s.json(t):s.status(404).send({success:!1,message:"salon not found"})})},updateSalon:function(e,s){Salon.update(e.params.id,e.body,function(e,t){e?s.send(e):s.send({success:!0,message:"salon Updated!"})})},deleteSalon:function(e,s){Salon.findById(e.params.id,e.body).remove(function(e,t){e?s.send(e):s.send({success:!0,message:"salon deleted from list"})})}};var Salon=require("../models/salon.model"),Hair=require("../models/hairstyle.model");exports.search=function(e,s){var t=new RegExp(e.body.term,"i"),r=[];Salon.find({$or:[{name:t},{address:t}]},function(a,o){a&&s.status(403).send({success:!1,message:"Ooops! An error occured."}),r.push(o),Hair.find({$or:[{name:t},{description:t}]},function(t,a){t?s.status(403).send({success:!1,message:"Ooops! An error occured."}):0===o.length&&0===a.length?s.status(200).send({success:!0,message:"Your search "+e.body.term+" does not match any Salons or Hairstyles."}):(r.push(a),s.status(200).send({success:!0,message:"Showing search results for "+e.body.term,data:{salons:r[0],hairstyles:r[1]}}))})})};var jwt=require("jsonwebtoken"),User=require("../models/user.model"),config=require("../../config/config"),Salon=require("../models/salon.model"),Hair=require("../models/hairstyle.model");exports.authMiddleware=function(e,s,t){var r=e.body.token||e.query.token||e.headers["x-access-token"];return r?void jwt.verify(r,config.secret,function(r,a){return r?s.json({success:!1,message:"Failed to authenticate token."}):(e.decoded=a,void t())}):s.status(403).send({success:!1,message:"No token provided."})},exports.getUser=function(e,s){User.find({username:e.params.username},function(e,t){e&&s.send(e),s.json(t)})},exports.editProfile=function(e,s){User.update({username:e.params.username},e.body,function(){s.json({message:"User updated!"})})},exports.deleteUser=function(e,s){User.remove({username:e.params.username},function(e){return e?s.send(e):void s.json({message:"Successfully deleted"})})},module.exports={errMessages:{username:"Invalid username",name:"Invalid first or last name",email:"Invalid email",password:"Invalid password",role:"Invalid role"},validators:{username:function(e){var s=/\S/.test(e);return s},name:function(e){if(e.first&&e.last){var s=/\D\S/.test(e.first+e.last);return s}return!1},email:function(e){var s=/\w+@/.test(e);return s},password:function(e){var s=/\S/.test(e);return s},role:function(e){var s;return s="user"!==e&&"stylist"!==e?!1:!0}},checkStatus:function(e,s){if(s){var t=this.validators[e](s);return t?0:this.errMessages[e]}return this.errMessages[e]},validate:function(e){var s=[];for(var t in this.errMessages)if(e.hasOwnProperty(t)){var r=this.checkStatus(t,e[t]);0!==r&&s.push(r)}else s.push(this.errMessages[t]);return s}};var mongoose=require("mongoose"),Salons=require("./salon.model"),Schema=mongoose.Schema,hairStyle=new Schema({name:{type:String,require:!0,required:"Please enter Hairstyle name",index:!0},description:{type:String,require:!0,required:"Please enter the Hairstyle description"},image:{type:String,require:!0,required:"Please upload a photo of the Hairstyle"},date:{type:Date,"default":Date.now("dd/mm/yyyy")},salon:{type:mongoose.Schema.Types.ObjectId,ref:"Salon"},rating:{type:Number}});module.exports=mongoose.model("Hair",hairStyle);var mongoose=require("mongoose"),Hairstyle=require("./hairstyle.model"),Schema=mongoose.Schema,Salons=new Schema({name:{type:String,unique:!0,require:!0,required:"Please enter salon name",index:!0},address:{type:String,unique:!0,require:!0,required:"Please enter the address of your salon"},hairstyles:[{type:mongoose.Schema.Types.ObjectId,ref:"Hair"}]});Salons.pre("remove",function(e){this.model("Hairstyle").remove({salon:this._id},e)}),module.exports=mongoose.model("Salon",Salons);var mongoose=require("mongoose"),Schema=mongoose.Schema,bcrypt=require("bcrypt-nodejs"),Salon=require("./salon.model"),userSchema=new Schema({name:{first:{type:String,required:!0},last:{type:String,required:!0}},username:{type:String,required:!0,index:{unique:!0},unique:!0},email:{type:String,required:!0,index:{unique:!0}},password:{type:String,required:!0},role:{type:String,required:!0,"enum":["user","stylist"]},salons:[{type:mongoose.Schema.Types.ObjectId,ref:"Salon"}]});userSchema.pre("save",function(e){var s=this;return s.isModified("password")?void bcrypt.hash(s.password,null,null,function(t,r){return t?e(t):(s.password=r,void e())}):e()}),userSchema.pre("remove",function(e){for(var s in this.salons)this.model("Salon").remove({_id:this.salons[s]});e()}),userSchema.methods.comparePassword=function(e){var s=this;return bcrypt.compareSync(e,s.password)},module.exports=mongoose.model("User",userSchema);var authCtrl=require("../controllers/auth.controller");module.exports=authRoutes;var hairCtrl=require("../controllers/hairstyle.controller");module.exports=hairstyleRoutes;var authRoutes=require("./auth.routes"),hairstyleRoutes=require("./hairstyle.routes"),salonRoutes=require("./salon.routes"),userRoutes=require("./user.routes"),searchRoutes=require("./search.routes");module.exports=routes;var salonCtrl=require("../controllers/salon.controller");module.exports=salonRoutes;var searchCtrl=require("../controllers/search.controller");module.exports=searchRoutes;var userCtrl=require("../controllers/user.controller");module.exports=userRoutes;var app=angular.module("hairvenApp",["ngFileUpload","ui.router","ngStorage","satellizer","ngToast"]);app.config(["$stateProvider","$urlRouterProvider","$locationProvider","$authProvider","ngToastProvider",function(e,s,t,r,a){e.state("home",{url:"/",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@home":{templateUrl:"app/partials/home.view.html",controller:"HomeCtrl"}}}).state("hair",{url:"/hair",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@hair":{templateUrl:"app/partials/hair.view.html",controller:"HairCtrl"}}}).state("dashboard",{url:"/dashboard",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@dashboard":{templateUrl:"app/partials/dashboard.view.html"}}}).state("contact",{url:"/contact",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@contact":{templateUrl:"app/partials/contact.view.html"}}}).state("Userdashboard",{url:"/userdashboard",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@Userdashboard":{templateUrl:"app/partials/Userdashboard.view.html"}}}).state("gallery",{url:"/gallery",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@gallery":{templateUrl:"app/partials/userGallery.view.html",controller:"HairCtrl"}}}).state("booking",{url:"/booking",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@booking":{templateUrl:"app/partials/booking.view.html"}}}).state("salongallery",{url:"/salongallery",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@salongallery":{templateUrl:"app/partials/shopOwnerGallery.view.html",controller:"HairCtrl"},"sideNav@salongallery":{templateUrl:"app/partials/salonSidenav.view.html",controller:"SalonCtrl"}}}).state("salon",{url:"/salon",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@salon":{templateUrl:"app/partials/salonPage.view.html"}}}).state("login",{url:"/login",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@login":{templateUrl:"app/partials/login.view.html",controller:"UserCtrl"}}}).state("registersalon",{url:"/registersalon",views:{"":{templateUrl:"app/partials/nav.view.html",controller:"UserCtrl"},"theView@registersalon":{templateUrl:"app/partials/salonSignup.view.html",controller:"UserCtrl"}}}),r.authHeader="x-access-token",a.configure({animation:"slide"}),s.otherwise("/"),t.html5Mode(!0),r.facebook({clientId:"1863446777214443"}),r.twitter({url:"/api/auth/twitter"})}]),angular.module("hairvenApp").controller("HairCtrl",["$scope","HairstyleService","$state","$rootScope","ngToast","Upload","baseUrl",function(e,s,t,r,a,o,n){e.addHairstyle=function(){var o=e.imageFile,n={name:e.name,description:e.description,salon:r.$storage.activeSalons[0]};s.addHairstyle(o,n).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),t.reload()}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getAllHairstyles=function(){s.getAllHairstyles().success(function(s){e.hairstyles=s}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getSalonHairstyles=function(t){var o=t||r.$storage.activeSalons[0];s.getSalonHairstyles(o).success(function(s){e.hairstyles=s.message||s}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.getOneHairstyle=function(e){s.getOneHairstyle(e).success(function(e){r.$storage.currentHairstyle=e.body}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.updateHairstyle=function(r){var o={name:e.name,description:e.description,salon:salonId};s.updateHairstyle(o).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),t.go("salongallery")}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},e.deleteHairstyle=function(e){s.deleteHairstyle(e).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}}]),angular.module("hairvenApp").controller("HomeCtrl",["$scope","$state",function(e,s){$(function(){$(".roll").css("opacity","0"),$(".roll").hover(function(){$(this).stop().animate({opacity:.7},"slow")},function(){$(this).stop().animate({opacity:0},"slow")})}),e.redirect=function(e){s.go(e)}}]),angular.module("hairvenApp").controller("SalonCtrl",["SalonService","$scope","$state","$rootScope","ngToast",function(e,s,t,r,a){s.addSalon=function(){var s={name:scope.salonName,address:scope.salonAddress};e.addSalon(s).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},s.getSalon=function(t){var o=t||r.$storage.activeSalons[0];e.getSalon(o).success(function(e){s.salonName=e.name,s.salonAddress=e.address}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},s.updateSalon=function(s){var t={name:scope.salonName,address:scope.salonAddress};e.updateSalon(s,t).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},s.deleteSalon=function(s){e.deleteSalon(s).success(function(e){a.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3}),state.go("salongallery")}).error(function(e){a.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}}]),angular.module("hairvenApp").controller("UserCtrl",["UserService","SalonService","$rootScope","$window","$scope","$state","$localStorage","$auth","ngToast",function(e,s,t,r,a,o,n,i,l){t.$storage=n,a.loggedIn=n.loggedIn,a.signin=function(){var s={username:a.username,password:a.password};e.login(s).success(function(e){"user"===e.user.role?(i.setToken(e.token),t.$storage.activeUser=e.user.username,t.$storage.userId=e.user._id,o.go("home")):(i.setToken(e.token),t.$storage.activeStylist=e.user.username,t.$storage.stylistId=e.user._id,t.$storage.activeSalons=e.user.salons,o.go("salongallery")),t.$storage.loggedIn=!0,l.create({className:"success",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},a.signup=function(){var t={name:a.salonName,address:a.salonAddress},r={name:{first:a.first,last:a.last},username:a.username,email:a.email,password:a.password,role:"user"};t.name&&t.address?s.addSalon(t).success(function(s){r.salons=s.salon._id,r.role="stylist",e.register(r).success(function(e){l.create({className:"success",content:e.message+" click on login to continue",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}):e.register(r).success(function(e){o.go("login"),l.create({className:"success",content:e.message+" login to continue",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})}).error(function(e){l.create({className:"danger",content:e.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},a.logout=function(){i.removeToken(),t.$storage.$reset(),e.logout(function(){"home"===o.$current.name?o.reload():o.go("home"),l.create({className:"success",content:"successfully logged out",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})},function(){l.create({className:"danger",content:"failed to logout!",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},a.authenticate=function(e){i.authenticate(e).then(function(e){i.setToken(e.data.token),t.$storage.activeUser=e.data.user.username,t.$storage.userId=e.data.user._id,o.go("home"),t.$storage.loggedIn=!0,l.create({className:"success",content:"You are signed in",dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})["catch"](function(e){l.create({className:"danger",content:e.data.message,dismissOnTimeout:!0,dismissOnClick:!0,timeout:2e3})})},a.isAuthenticated=function(){i.isAuthenticated()}}]),angular.module("hairvenApp").value("baseUrl","http://localhost:3030");var app=angular.module("hairvenApp");app.factory("HairstyleService",["$http","baseUrl","$localStorage","Upload",function(e,s,t,r){var a={getAllHairstyles:function(){return e.get(s+"/api/hairstyles/")},getSalonHairstyles:function(t){return e.get(s+"/api/salons/"+t+"/hairstyles")},getOneHairstyle:function(t){return e.get(s+"/api/hairstyles/"+t)},addHairstyle:function(e,t){return r.upload({url:s+"/api/hairstyles",data:{hairPhoto:e,name:t.name,description:t.description,salon:t.salon},method:"POST"})},updateHairstyle:function(t,r){return e.put(s+"/api/hairstyles/"+t,r)},deleteHairstyle:function(t){return e["delete"](s+"/api/hairstyles/"+t)}};return a}]);var app=angular.module("hairvenApp");app.factory("SalonService",["$http","baseUrl","$localStorage",function(e,s,t){var r={getSalon:function(t){return e.get(s+"/api/salons/"+t)},addSalon:function(t){return e.post(s+"/api/salons/",t)},updateSalon:function(t,r){return e.put(s+"/api/salons/"+t,r)},deleteSalon:function(t){return e["delete"](s+"/api/salons/"+t)}};return r}]);var app=angular.module("hairvenApp");app.factory("UserService",["$http","baseUrl","$localStorage",function(e,s,t){function r(e){var s=e.replace("-","+").replace("_","/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw"Illegal base64url string!"}return window.atob(s)}function a(){var e=t.token,s={};if("undefined"!=typeof e){var a=e.split(".")[1];s=JSON.parse(r(a))}return s}function o(e){angular.extend(n.currentUser,e)}var n=(a(),{register:function(t){return e.post(s+"/api/signup",t)},login:function(t){return e.post(s+"/api/login",t)},facebookLogin:function(){e.get(s+"/api/auth/facebook/")},twitterLogin:function(){e.get(s+"/api/auth/twitter/")},logout:function(e){o({}),e()},currentUser:function(){a()},updateUser:function(t,r,a){e.put(s+"/api/users/"+t).success(r).error(a)},deleteUser:function(t,r,a){e["delete"](s+"/api/users/"+t).success(r).error(a)}});return n}]);